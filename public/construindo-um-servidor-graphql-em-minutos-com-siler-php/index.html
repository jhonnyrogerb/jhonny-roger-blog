<!DOCTYPE html>
<html>
<head>
	<title>Sejedev - "Seje" dev, não seja sobrinho!</title>
	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

	<link rel="stylesheet" type="text/css" href="http://localhost/jhonny-roger/public/css/style.min.css?1500245837">
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
	  (adsbygoogle = window.adsbygoogle || []).push({
	    google_ad_client: "ca-pub-9403183739906461",
	    enable_page_level_ads: true
	  });
	</script>
</head>
<body>
	<header id="sd-header">
		<a href="http://localhost/jhonny-roger/public/" id="sd-logo">Sejedev</a>
		<nav id="sd-nav-menu">
			<ul>
				<li><a href="http://localhost/jhonny-roger/public/categories/nodejs">Artigos</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Noticias</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Projetos</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Colabore</a></li>
			</ul>
		</nav>
		<form action="#" id="sd-search-form">
			<input type="search" name="search" placeholder="Faça a sua busca!">
		</form>
	</header>
<section id="sd-main-post">
    
    <h1>
        <a href="/jhonny-roger/public/frontend-week/">
            Front-end Week
        </a>
    </h1>
    <p class="sd-main-excerpt">
         Uma overdose de eventos e palestras sobre front-end em uma semana. 
    </p>
    <p class="sd-main-author">
        por <a href="/jhonny-roger/public/author/diego-eis">Diego Eis"</a>27/06/2017
    </p>
    
</section>



<div class="tb-post">

  <section class="tb-post-content">
    <article class="tb-post-article">
      <p>Apresento-lhes:</p>

<p><a href="http://graphql.org/">GraphQL</a>: uma query language como o SQL, mas desenhada para rodar no lado <em>client</em>, no caso: front-end.</p>

<p><a href="https://github.com/leocavalcante/siler">Siler</a>: uma biblioteca PHP que tem como diferencial simplificar o desenvolvimento evitando <em>overheads</em>.
<h2>GraphQL</h2>
A GraphQL trás, na verdade, uma nova abordagem pro desenvolvimento, ela praticamente faz uma inversão de quem fará a consulta aos dados, ou pelo menos, trás essa possibilidade pro lado <em>client</em>, o lado front-end, que antes era refém do que o back-end devolvia no JSON e principalmente a forma como esses dados estavam relacionados nesse JSON.</p>

<p><strong>Graças à GraphQL, nós podemos trazer esse poder de consulta e interface de dados pro <em>client</em>.</strong></p>

<p>É uma tecnologia desenvolvida pelo Facebook, caprichada pra funcionar com React, mas vai muito bem com outras bibliotecas JavaScript e até <em>clients</em> que não sejam o navegador como Android (Java) e iOS (Swift/Obj-C).</p>

<p><a href="https://www.youtube.com/watch?v=9sc8Pyc51uU">https://www.youtube.com/watch?v=9sc8Pyc51uU</a></p>

<p>Na especificação da GraphQL tem um conceito de extrema relevância pra tecnologia que é o sistema de tipos (<em><a href="http://facebook.github.io/graphql/#sec-Type-System">Type System</a></em>). Isso faz com que seus dados sejam forte e estaticamente &ldquo;tipados&rdquo;, algo bem diferente do que estamos acostumados com JSON e principalmente Percent-encoding (application/x-www-form-urlencoded) onde tudo é uma String. Mas isso é uma especificação e o lado que infere a implementação é o do servidor; <em>então o que o PHP tá fazendo aqui, Léo?</em> Bom, hoje o PHP 7 tem um sistema de declaração de tipos que pode até ser estrito dentro do seu projeto, mas a GraphQL não é sobre os tipos da linguagem que você implementa é sobre os tipos do seu <em>endpoint</em>, eles são normalmente implementados de acordo com seu domínio, suas <em>entities</em> (ou <em>Models</em> pra galera que curte um MVC).</p>

<p>Claro, você não precisa implementar do zero tipo primitivos escalares como Int, Float, String, Boolean e ID (se usar uma biblioteca descente). E existem tipos abstratos pra você usar como base na implementação dos seus próprios tipos como: Object, Interface e List.</p>

<p>Por falar em biblioteca descente, a Siler não implementa a GraphQL, ela é um <em>wrapper</em> da <a href="https://github.com/webonyx/graphql-php">graphql-php</a>, importante ressaltar isso e dar os devidos créditos.
<h3>Chega de &ldquo;falar&rdquo;. Bora pro código!</h3>
Vamos criar um projetinho PHP usando Composer e um template bem simples da Siler.</p>

<pre class="lang-bash">$ composer create-project siler/project siler-graphql</pre>

<p>Caso não conheça o <a href="https://getcomposer.org/">Composer</a>, esse comando vai clonar o projeto <a href="https://github.com/leocavalcante/siler-project">leocavalcante/siler-project</a> e depois executar <code>composer install</code> pra instalar as dependências, que nesse caso é só a <a href="https://github.com/leocavalcante/siler">Siler</a> mesmo.</p>

<p>Como falei antes, a Siler não implementa a especificação da GraphQL, nela acompanha um <em>wrapper/helper</em> de uma biblioteca que já implementa essa especificação. Na Siler as dependências são explícitas, então vamos entrar no diretório do projeto e trazer a graphql-php:</p>

<pre class="lang-shell">$ cd siler-graphql
$ composer require webonyx/graphql-php
</pre>

<p>E agora nosso <code>index.php</code> vai ficar da seguinte forma:</p>

<pre class="lang-php">&lt;?php

use Siler\{
    Route,
    Http\Response,
    Functional as F,
    Graphql
};

require_once __DIR__.'/vendor/autoload.php';

$query = Graphql\type('Query')([
    Graphql\str('foo')(F\always('bar'))
]);

Response\header('Access-Control-Allow-Headers', 'content-type');
Response\header('Access-Control-Allow-Origin', 'http://localhost:3000');

Graphql\init(new \GraphQL\Schema([
    'query' =&gt; $query(),
]));
</pre>

<p>Não se assuste, vou explicar.</p>

<p>No primeiro bloco (3-8) estamos declarando o que iremos usar da Siler, como podem notar, ela não é só pra GraphQL, também abstrai HTTP e alguns conceitos de programação functional. E é bom deixar claro: estamos usando a notação agrupada da <em>keyword</em> <code>use</code> que veio com o PHP 7.</p>

<p>O que importa pra gente é 12-14 e 19-21, porque na 16 e 17 estamos apenas declarando alguns <em>headers</em> que irão na nossa resposta HTTP pro <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> funcionar direitinho.</p>

<p>No bloco 12-14 estamos declarando um novo tipo GraphQL, aquele comentado anteriormente, com a Siler é só questão de chamar uma função. Na <code>Siler\Graphql\type</code> nós declaramos um <a href="http://facebook.github.io/graphql/#sec-Objects"><code>ObjectType</code></a> de nome Query, ali pode ser qualquer nome que você queira dar pra <a href="http://facebook.github.io/graphql/#sec-Initial-types">Root Query</a> do seu endpoint GraphQL. Essa função retorna outra função (porque programação funcional rulez) onde o primeiro argumento é um <em>array</em> de <em>fields</em>. Na linha 13 nós estamos declarando um novo <em>field</em> do tipo <a href="http://facebook.github.io/graphql/#sec-String"><em>String</em></a> e com mais um extra-help da Siler, passamos a função <code>always</code> que significa que vai retornar sempre esse mesmo valor (&lt;code&gt;bar&lt;/code&gt;) independente dos argumentos que essa função for chamada (<a href="http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:const"><em>vide <code>const</code> do Haskell</em></a>).</p>

<p>No bloco 19-21 nós estamos iniciando um novo <em>endpoint</em> que irá ouvir e interpretar a <em>query</em> de GraphQL que veio no <em>request</em>. Estamos prontos para testar a funcionalidade da nossa API e existe uma ferramenta excelente pra isso, onde podemos testar <em>endpoints</em> GraphQL com uma interface gráfica - seria o Postman do GraphQL - é do próprio Facebook e se chama <a href="https://github.com/graphql/graphiql">GraphiQL</a>!</p>

<p>Se você estiver com dificuldades para configurar seu app GraphiQL, pode dar uma olhada <a href="https://github.com/leocavalcante/graphiql-app">nesse projeto</a>.</p>

<p>Com o GraphiQL rodando na 3000 (default do create-react-app) e a API na 8000 (default do siler/project). Podemos testar nosso <em>endpoint</em> com a premissa de que uma chamada pro <em>field</em> <code>foo</code> na <code>Query</code> o retorno deve ser <code>bar</code>:</p>

<p><img class="alignnone size-full wp-image-57429" src="uploads/2017/03/Capture.png" alt="" width="370" height="233" /></p>

<p><strong>Maravilha!</strong> Temos aí um Hello World de GraphQL com PHP em apenas 20 linhas de código.</p>

<p>Já tem muita informação pra um post só, que inclusive tá cheio de links pra você se aprofundar no assunto e descobrir que tem algo chamado <em>mutations</em> que seria a especificação para mudanças na GraphQL que não é feita só de consultas.</p>

<p>Se não aguenta esperar um próximo post e já sacou a ideia. Tem um <a href="https://github.com/leocavalcante/siler#graphql">trechinho no README da Siler</a> com uma <em>mutation</em> que faz a soma de dois argumentos.</p>

<p>Espero que tenha se interessado pela GraphQL, IMHO é uma tecnologia divisora de águas trazendo esse conceito de <em>queries</em> pro front-end. Nós temos caminhado cada vez mais para soluções menos monolíticas onde o <em>client</em> e o <em>server</em> estão bem separados e essa é a &ldquo;cola&rdquo; que eles precisam!</p>

    </article>

    <div class="tb-related-posts">
      <h3>Leia mais:</h3>
      <ul>
        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/indo-alem-no-react-native//?utm_source=tablelessRelatedLin">Indo além no Mundo React-Native</a><br />
        </li>

        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/velocidade-tableless-estatico//?utm_source=tablelessRelatedLin">Performance do Tableless estático</a><br />
        </li>

        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/seu-primeiro-bot-para-o-telegram//?utm_source=tablelessRelatedLin">Seu primeiro bot para o Telegram</a><br />
        </li>

        
      </ul>
    </div>

  </section>
</div>

<footer id="sd-footer">
</footer>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script type="text/javascript" src="http://localhost/jhonny-roger/public/js/main.js?1500245838"></script>