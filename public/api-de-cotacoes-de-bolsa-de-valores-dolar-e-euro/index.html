<!DOCTYPE html>
<html>
<head>
	<title>Sejedev - "Seje" dev, não seja sobrinho!</title>
	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

	<link rel="stylesheet" type="text/css" href="http://localhost/jhonny-roger/public/css/style.min.css?1500245847">
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
	  (adsbygoogle = window.adsbygoogle || []).push({
	    google_ad_client: "ca-pub-9403183739906461",
	    enable_page_level_ads: true
	  });
	</script>
</head>
<body>
	<header id="sd-header">
		<a href="http://localhost/jhonny-roger/public/" id="sd-logo">Sejedev</a>
		<nav id="sd-nav-menu">
			<ul>
				<li><a href="http://localhost/jhonny-roger/public/categories/nodejs">Artigos</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Noticias</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Projetos</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Colabore</a></li>
			</ul>
		</nav>
		<form action="#" id="sd-search-form">
			<input type="search" name="search" placeholder="Faça a sua busca!">
		</form>
	</header>
<section id="sd-main-post">
    
    <h1>
        <a href="/jhonny-roger/public/frontend-week/">
            Front-end Week
        </a>
    </h1>
    <p class="sd-main-excerpt">
         Uma overdose de eventos e palestras sobre front-end em uma semana. 
    </p>
    <p class="sd-main-author">
        por <a href="/jhonny-roger/public/author/diego-eis">Diego Eis"</a>27/06/2017
    </p>
    
</section>



<div class="tb-post">

  <section class="tb-post-content">
    <article class="tb-post-article">
      <p>Hoje em dia é muito comum os sites terem um widget ou uma barra lateral com informações de cotações do dólar, euro e os principais mercados financeiros do mundo.</p>

<p>Como o mercado oscila muito, essas informações são atualizadas constantemente, de minuto a minuto. Se você está pensando em mostrar essas informações em seu site, com certeza vai precisar de uma API para consultar estes dados em tempo real.</p>

<p>O pessoal da <a href="http://agenciaideias.com.br" target="_blank">Agência Ideias</a> criou uma <a href="http://developers.agenciaideias.com.br/cotacoes" target="_blank">API</a> bem legal para consulta de cotações em tempo real, sendo o valor do euro e do dólar referentes aos valores de compra dessas moedas. O formato do retorno da consulta pode ser <a href="http://developers.agenciaideias.com.br/cotacoes/json" target="_blank">JSON</a> ou <a href="http://developers.agenciaideias.com.br/cotacoes/xml" target="_blank">XML</a>, dependendo da necessidade de sua aplicação. Para a nossa classe em PHP, vamos utilizar o formato de retorno em JSON.</p>

<p>Vamos criar um novo arquivo em PHP com o nome <strong>Quotation.php</strong>. Nele vamos criar a classe <strong>Quotation</strong>. Logo no início da classe, vamos declarar duas variáves estáticas que serão usadas por nossa classe. Uma delas é o endereço da API e a outra é o conteúdo que será retornado por ela.</p>

<pre class="lang-php">class Quotation {

  private static $apiUrl = "http://developers.agenciaideias.com.br/cotacoes/json";
  private static $content;

}
</pre>

<p>Em seguida, vamos criar um método estático para preparar nossa classe para a interação com a API:</p>

<pre class="prettyprint php">public static function init() {

  self::$content = file_get_contents(self::$apiUrl);
  self::$content = json_decode(self::$content);
}
</pre>

<p>O conteúdo do retorno da API é semelhante a este:</p>

<pre class="lang-javascript">{
  "bovespa":{
    "cotacao":"46955",
    "variacao":"-0.14"
  },
  "dolar": {
    "cotacao":"2.7500",
    "variacao":"+2.34"
  },
  "euro":{
    "cotacao":"3.4427",
    "variacao":"+2.65"
  },
  "atualizacao":"16\/12\/14   - 14:08"
}
</pre>

<p>Para que possamos organizar melhor as informações, vamos criar um método para cada tipo de cotação:</p>

<pre class="lang-php">public static function dolar() {

        self::init();
        return array(
            "quotation" =&gt; self::$content-&gt;dolar-&gt;cotacao,
            "variation" =&gt; self::$content-&gt;dolar-&gt;variacao,
            "status" =&gt; self::getVariation(self::$content-&gt;dolar-&gt;variacao)
        );
    }

    public static function bovespa() {

        self::init();
        return array(
            "quotation" =&gt; self::$content-&gt;bovespa-&gt;cotacao,
            "variation" =&gt; self::$content-&gt;bovespa-&gt;variacao,
            "status" =&gt; self::getVariation(self::$content-&gt;bovespa-&gt;variacao)
        );
    }

    public static function euro() {

        self::init();
        return array(
            "quotation" =&gt; self::$content-&gt;euro-&gt;cotacao,
            "variation" =&gt; self::$content-&gt;euro-&gt;variacao,
            "status" =&gt; self::getVariation(self::$content-&gt;euro-&gt;variacao)
        );
    }

</pre>

<p>Cada um destes métodos utiliza o método <strong>init()</strong> que inicializa a interação da nossa classe com a API e guarda o retorno na variável estática de classe <strong>self::$content</strong>.</p>

<p>Por último, vamos criar um último método apenas para verificar se a variação teve uma alta ou uma baixa:</p>

<pre class="lang-php">public static function getVariation($variation) {
        if (strpos($variation, "+")) {
            return "+";
        } else {
            return "-";
        }
  }
</pre>

<p>Como exemplo, vamos verificar a cotação do dólar:</p>

<pre class="lang-php">$dolar = Quotation::dolar();
  echo "Cotação do Dólar:\n";
  echo "Valor: R$" . number_format($dolar['quotation'], 2, ',', '.') . "\n";
  echo "Variação: {$dolar['variation']}";
</pre>

<p>A classe pode ser baixada na íntegra <a title="QuotationAPI" href="https://github.com/hmschreiner/QuotationAPI" target="_blank">aqui</a>.</p>

<p>Espero que tenham gostado do post. <strong>Não deixem de comentar e deixar suas dúvidas.</strong></p>

    </article>

    <div class="tb-related-posts">
      <h3>Leia mais:</h3>
      <ul>
        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/teste-de-carga-em-apis-utilizando-artillery//?utm_source=tablelessRelatedLin">Teste de carga em APIs utilizando Artillery</a><br />
        </li>

        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/silex-2-middlewares-101-parte-02//?utm_source=tablelessRelatedLin">Silex 2 &amp; Middlewares 101 – Parte 02</a><br />
        </li>

        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/codigo-limpo-escreva-seu-codigo-hoje-sem-esquecer-da-manutencao-de-amanha//?utm_source=tablelessRelatedLin">Código Limpo – Escreva seu código hoje sem esquecer da manutenção de amanhã</a><br />
        </li>

        
      </ul>
    </div>

  </section>
</div>

<footer id="sd-footer">
</footer>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script type="text/javascript" src="http://localhost/jhonny-roger/public/js/main.js?1500245847"></script>