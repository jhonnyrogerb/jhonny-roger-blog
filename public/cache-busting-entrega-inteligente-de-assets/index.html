<!DOCTYPE html>
<html>
<head>
	<title>Sejedev - "Seje" dev, não seja sobrinho!</title>
	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

	<link rel="stylesheet" type="text/css" href="http://localhost/jhonny-roger/public/css/style.min.css?1500245844">
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
	  (adsbygoogle = window.adsbygoogle || []).push({
	    google_ad_client: "ca-pub-9403183739906461",
	    enable_page_level_ads: true
	  });
	</script>
</head>
<body>
	<header id="sd-header">
		<a href="http://localhost/jhonny-roger/public/" id="sd-logo">Sejedev</a>
		<nav id="sd-nav-menu">
			<ul>
				<li><a href="http://localhost/jhonny-roger/public/categories/nodejs">Artigos</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Noticias</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Projetos</a></li>
				<li><a href="http://localhost/jhonny-roger/public/categories/jquery">Colabore</a></li>
			</ul>
		</nav>
		<form action="#" id="sd-search-form">
			<input type="search" name="search" placeholder="Faça a sua busca!">
		</form>
	</header>
<section id="sd-main-post">
    
    <h1>
        <a href="/jhonny-roger/public/frontend-week/">
            Front-end Week
        </a>
    </h1>
    <p class="sd-main-excerpt">
         Uma overdose de eventos e palestras sobre front-end em uma semana. 
    </p>
    <p class="sd-main-author">
        por <a href="/jhonny-roger/public/author/diego-eis">Diego Eis"</a>27/06/2017
    </p>
    
</section>



<div class="tb-post">

  <section class="tb-post-content">
    <article class="tb-post-article">
      

<h2 id="definição">Definição</h2>

<p>Cache busting nada mais é do que uma técnica para contornar o problema do carregamento de versões antigas dos assets armazenados em cache no navegador do cliente.</p>

<h2 id="problema">Problema</h2>

<p>Na verdade, essa é uma questão de longa data. Muitos desenvolvedores utilizam-se do incremento de variáveis com códigos aleatórios no final das chamadas (querystrings) dos assets para contornar o problema, o que, de acordo com <a href="http://stevesouders.com/">Steve Souders</a>, guru em performance de sites na web, não é uma boa prática.</p>

<pre class="lang-html">&lt;link rel="stylesheet" href="assets/main.css?v=786523"&gt; &lt;!-- NÃO RECOMENDADO! --&gt;
</pre>

<p>Segundo Souders, <a href="http://www.stevesouders.com/blog/2008/08/23/revving-filenames-dont-use-querystring/">o uso de querystrings não é bom</a> porque faz com que normalmente o browser recarregue o asset da origem. Para o ambiente de desenvolvimento isso seria o ideal. Para o usuário final isso não seria bom, pois o comportamento de seu navegador seria alterado em termos do número de conexões que são abertas, ignorando o uso do cache e comprometendo a performance de carregamento da página.</p>

<h2 id="solução">Solução</h2>

<p>Para resolver o problema sem a utilização de querystrings, o ideal é que todos os arquivos de assets que estão sendo requisitados na página sejam renomeados. Logicamente que as chamadas para esses assets renomeados também precisam ser atualizadas na página. Sabemos que fazer esse processo manualmente seria algo árduo, quase insano. Então como fazê-lo de forma elegante, automatizada?</p>

<p>A fórmula mágica para que isso aconteça de maneira prática é o <a href="https://github.com/hollandben/grunt-cache-bust">grunt-cache-bust</a>, um plugin para o <a href="http://tableless.com.br/grunt-voce-deveria-estar-usando/">Grunt</a>.</p>

<h3 id="show-me-the-code">Show me the code</h3>

<p>Vou supor que você já conhece o <a href="http://gruntjs.com/">Grunt</a> e que há uma <em>index.html</em> na raiz de seu projeto, ok? Sendo assim, irei focar apenas na utilização do plugin.</p>

<p>A princípio você só precisa seguir 4 passos básicos para usar o grunt-cache-bust:</p>

<ol>
<li>Instale o plugin usando o seguinte comando:</li>
</ol>

<pre class="lang-sh">npm install grunt-cache-bust --save-dev
</pre>

<ol>
<li>Em seu <em>Gruntfile.js</em>, adicione a seguinte propriedade ao objeto passado como parâmetro em <em>grunt.initConfig</em>:</li>
</ol>

<pre class="lang-js">cacheBust: {
  options: {
    encoding: 'utf8',
    length: 16
  },
  scripts: {
    files: [{
      src: ['index.html']
    }]
  }
}
</pre>

<ol>
<li>Ainda em seu <em>Gruntfile.js</em>, adicione a seguinte linha para ativar o plugin:</li>
</ol>

<pre class="lang-js">grunt.loadNpmTasks('grunt-cache-bust');
</pre>

<ol>
<li>Tudo certo, agora é só rodar a task e voilà!</li>
</ol>

<pre class="lang-sh">grunt cacheBust
</pre>

<h3 id="resultado">Resultado</h3>

<p>Lembra que na raíz de seu projeto há uma <em>index.html</em>? Então, basicamente a task vai varrer esse documento buscando por chamadas de assets (CSS, JS, imagens e favicons), copiar esses arquivos com um novo nome e atualizar o source de cada chamada encontrada com o novo nome do arquivo. Esse novo nome terá o formato {nome}.{hash}.{extensão}, onde {hash} seria um código aleatório.</p>

<p><em>index.html</em> antes:</p>

<pre class="lang-html">&lt;script src="assets/main.js"&gt;&lt;/script&gt;</pre>

<p><em>index.html</em> depois:</p>

<pre class="lang-html">&lt;script src="assets/main.6419373d85d7afe3.js"&gt;&lt;/script&gt;
</pre>

<p>Lindo, né?</p>

<p>Vale lembrar que o plugin irá ignorar automaticamente chamadas que apontam para CDNs.</p>

<p>A propriedade <a href="https://github.com/hollandben/grunt-cache-bust#options">options</a> do plugin oferece uma porção de possibilidades interessantes que flexibilizam a utilização do cache busting, como por exemplo manter ou não os arquivos originais dos assets requisitados, escolher o algoritmo e tamanho das hashes, ignorar chamadas de assets através de regex, etc. Enfim, considere dar uma boa olhada na <a href="https://github.com/hollandben/grunt-cache-bust#getting-started">documentação oficial do plugin</a>.</p>

<h2 id="conclusão">Conclusão</h2>

<p>Cache busting é algo realmente útil no ciclo de desenvolvimento web. Chega de <em>Cmd+Shift+R</em> ou <em>Ctrl+F5</em>, né?</p>

<p>Se você tem alguma outra solução para essa questão, utilizando Gulp ou outra ferramenta, conta pra gente aqui nos comentários. A comunidade agradece! ;D</p>

    </article>

    <div class="tb-related-posts">
      <h3>Leia mais:</h3>
      <ul>
        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/velocidade-tableless-estatico//?utm_source=tablelessRelatedLin">Performance do Tableless estático</a><br />
        </li>

        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/teste-de-carga-em-apis-utilizando-artillery//?utm_source=tablelessRelatedLin">Teste de carga em APIs utilizando Artillery</a><br />
        </li>

        
        <li class="tb-related-post">
          <a href="/jhonny-roger/public/o-que-aprendi-em-5-dias-como-front-end--e-uma-pergunta-voce-esta-preparado-para-se-tornar-um-desenvolvedor//?utm_source=tablelessRelatedLin">O que aprendi em 5 dias como Front-end, e uma pergunta: você esta preparado para se tornar um desenvolvedor?</a><br />
        </li>

        
      </ul>
    </div>

  </section>
</div>

<footer id="sd-footer">
</footer>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script type="text/javascript" src="http://localhost/jhonny-roger/public/js/main.js?1500245844"></script>